(window.webpackJsonp=window.webpackJsonp||[]).push([[145],{685:function(t,a,s){"use strict";s.r(a);var n=s(19),e=Object(n.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"单元测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#单元测试"}},[t._v("#")]),t._v(" 单元测试")]),t._v(" "),a("h3",{attrs:{id:"什么是单元测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是单元测试"}},[t._v("#")]),t._v(" 什么是单元测试？")]),t._v(" "),a("p",[t._v("Unit Testing，又称为模块测试，是针对程序模块来进行正确性检验的测试工作。程序单元是应用的最小可测试部件。在过程化编程中，一个单元就是单个程序、函数、过程等；对于面向对象编程，最小单元就是方法，包括基类（超类）、抽象类、或者派生类（子类）中的方法。")]),t._v(" "),a("h3",{attrs:{id:"为什么需要单元测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#为什么需要单元测试"}},[t._v("#")]),t._v(" 为什么需要单元测试？")]),t._v(" "),a("ul",[a("li",[t._v("可能会测出功能的隐藏bug。")]),t._v(" "),a("li",[t._v("保证代码重构的安全性。\n"),a("ul",[a("li",[t._v("组件库中每⼀个组件都可能会重构或者更新迭代，如果单元测试覆盖率⾼的话，修改代码之后就越可能会发现潜在的问题。⽐如版本升级后，导致某部分功能的缺失。")])])]),t._v(" "),a("li",[t._v("自动检测，可以做到一次编写，多次运行，节省重复测试的时间")])]),t._v(" "),a("h3",{attrs:{id:"技术选型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#技术选型"}},[t._v("#")]),t._v(" 技术选型")]),t._v(" "),a("p",[t._v("单元测试用到的工具大致分为三部分：分别为"),a("strong",[t._v("管理工具")]),t._v("、"),a("strong",[t._v("测试框架")]),t._v("、"),a("strong",[t._v("断言库")]),t._v("。")]),t._v(" "),a("p",[t._v("本文选用Karma、Mocha和Chai。")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("Karma")]),t._v(" 是一个基于 Node.js 的 JavaScript 测试执行过程管理工具，又称 "),a("code",[t._v("Test Runner")]),t._v("。常用的管理工具还有 "),a("code",[t._v("Jest")]),t._v(" 等。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("Mocha")]),t._v(' 是一个功能丰富的前端测试框架。所谓"测试框架"，就是运行测试的工具。通过它，可以为 JavaScript 应用添加测试用例，从而保证代码的质量。'),a("code",[t._v("Mocha")]),t._v(" 既可以基于 Node.js 环境运行也可以在浏览器环境运行。常用的测试框架还有 "),a("code",[t._v("Asmine")]),t._v(" 、 "),a("code",[t._v("Jasmine")]),t._v(" 等。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("Chai")]),t._v(" 是一个断言库，类似于 Node 的内置断言。通过提供许多可以针对代码运行的断言，它使测试变得更加容易。")])])]),t._v(" "),a("h3",{attrs:{id:"karma"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#karma"}},[t._v("#")]),t._v(" Karma")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("作用：提供测试环境（呼起浏览器，加载测试脚本，然后运行测试用例）")])]),t._v(" "),a("li",[a("p",[t._v("配置：具体配置写在 karma.conf.js 中")])]),t._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://v1.test-utils.vuejs.org/zh/installation/#%E7%94%A8-karma-%E6%B5%8B%E8%AF%95%E5%8D%95%E6%96%87%E4%BB%B6%E7%BB%84%E4%BB%B6",target:"_blank",rel:"noopener noreferrer"}},[t._v("用 Karma 测试单文件组件"),a("OutboundLink")],1)])])]),t._v(" "),a("h3",{attrs:{id:"mocha-chai-sinon"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mocha-chai-sinon"}},[t._v("#")]),t._v(" Mocha/chai/Sinon")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("作用：提供测试语法")])]),t._v(" "),a("li",[a("p",[t._v("Mocha：describe，it 语法")])]),t._v(" "),a("li",[a("p",[t._v("chai：expect 语法")])]),t._v(" "),a("li",[a("p",[t._v("Sinon/Sinon-Chai：为组件的事件测试设置回调函数")])])]),t._v(" "),a("h3",{attrs:{id:"目录结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#目录结构"}},[t._v("#")]),t._v(" 目录结构")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("|-- tests\n    |-- unit\n        |-- specs\n        \t\t|-- xxx.spec.js\n        |-- karma.conf.js\n        |-- index.js\n")])])]),a("h3",{attrs:{id:"测试对象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#测试对象"}},[t._v("#")]),t._v(" 测试对象")]),t._v(" "),a("ul",[a("li",[t._v("测DOM元素是否存在")]),t._v(" "),a("li",[t._v("测props是否接受")]),t._v(" "),a("li",[t._v("测事件")]),t._v(" "),a("li",[t._v("CSS不测")])]),t._v(" "),a("h3",{attrs:{id:"关于异步"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关于异步"}},[t._v("#")]),t._v(" 关于异步")]),t._v(" "),a("p",[t._v("由于DOM元素的渲染是异步的，所以我们往往需要在设置 PropsData 后异步地测试DOM元素情况")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("it")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'toast 接受 autoClose　属性'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("done")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" wrapper "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mount")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Toast"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("propsData")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("autoClose")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 确保在vm.execAutoClose执行后再去判断vm.$el是否被移出document.body")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 判断vm.$el是否被移出document.body")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("expect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("contains")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wrapper"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("element"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("equal")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("done")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" wrapper"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("props")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'autoClose'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);